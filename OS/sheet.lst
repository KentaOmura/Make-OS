     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_memman_alloc_4k
     7 00000000                                 [FILE "sheet.c"]
     8                                          [SECTION .text]
     9 00000000                                 	GLOBAL	_shtctl_init
    10 00000000                                 _shtctl_init:
    11 00000000 55                              	PUSH	EBP
    12 00000001 89 E5                           	MOV	EBP,ESP
    13 00000003 68 00002410                     	PUSH	9232
    14 00000008 FF 75 08                        	PUSH	DWORD [8+EBP]
    15 0000000B E8 [00000000]                   	CALL	_memman_alloc_4k
    16 00000010 89 C2                           	MOV	EDX,EAX
    17 00000012 58                              	POP	EAX
    18 00000013 59                              	POP	ECX
    19 00000014 31 C0                           	XOR	EAX,EAX
    20 00000016 85 D2                           	TEST	EDX,EDX
    21 00000018 74 31                           	JE	L1
    22 0000001A 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    23 0000001D B9 000000FF                     	MOV	ECX,255
    24 00000022 89 02                           	MOV	DWORD [EDX],EAX
    25 00000024 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
    26 00000027 89 42 04                        	MOV	DWORD [4+EDX],EAX
    27 0000002A 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    28 0000002D 89 42 08                        	MOV	DWORD [8+EDX],EAX
    29 00000030 8D 82 0000042C                  	LEA	EAX,DWORD [1068+EDX]
    30 00000036 C7 42 0C FFFFFFFF               	MOV	DWORD [12+EDX],-1
    31 0000003D                                 L7:
    32 0000003D C7 00 00000000                  	MOV	DWORD [EAX],0
    33 00000043 83 C0 20                        	ADD	EAX,32
    34 00000046 49                              	DEC	ECX
    35 00000047 79 F4                           	JNS	L7
    36 00000049 89 D0                           	MOV	EAX,EDX
    37 0000004B                                 L1:
    38 0000004B C9                              	LEAVE
    39 0000004C C3                              	RET
    40 0000004D                                 	GLOBAL	_sheet_alloc
    41 0000004D                                 _sheet_alloc:
    42 0000004D 55                              	PUSH	EBP
    43 0000004E 31 D2                           	XOR	EDX,EDX
    44 00000050 89 E5                           	MOV	EBP,ESP
    45 00000052 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    46 00000055 05 00000410                     	ADD	EAX,1040
    47 0000005A                                 L16:
    48 0000005A 83 78 1C 00                     	CMP	DWORD [28+EAX],0
    49 0000005E 74 10                           	JE	L19
    50 00000060 42                              	INC	EDX
    51 00000061 83 C0 20                        	ADD	EAX,32
    52 00000064 81 FA 000000FF                  	CMP	EDX,255
    53 0000006A 7E EE                           	JLE	L16
    54 0000006C 31 C0                           	XOR	EAX,EAX
    55 0000006E                                 L10:
    56 0000006E 5D                              	POP	EBP
    57 0000006F C3                              	RET
    58 00000070                                 L19:
    59 00000070 C7 40 1C 00000001               	MOV	DWORD [28+EAX],1
    60 00000077 C7 40 18 FFFFFFFF               	MOV	DWORD [24+EAX],-1
    61 0000007E EB EE                           	JMP	L10
    62 00000080                                 	GLOBAL	_sheet_setbuf
    63 00000080                                 _sheet_setbuf:
    64 00000080 55                              	PUSH	EBP
    65 00000081 89 E5                           	MOV	EBP,ESP
    66 00000083 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    67 00000086 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    68 00000089 89 02                           	MOV	DWORD [EDX],EAX
    69 0000008B 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
    70 0000008E 89 42 04                        	MOV	DWORD [4+EDX],EAX
    71 00000091 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    72 00000094 89 42 08                        	MOV	DWORD [8+EDX],EAX
    73 00000097 8B 45 18                        	MOV	EAX,DWORD [24+EBP]
    74 0000009A 89 42 14                        	MOV	DWORD [20+EDX],EAX
    75 0000009D 5D                              	POP	EBP
    76 0000009E C3                              	RET
    77 0000009F                                 	GLOBAL	_sheet_updown
    78 0000009F                                 _sheet_updown:
    79 0000009F 55                              	PUSH	EBP
    80 000000A0 89 E5                           	MOV	EBP,ESP
    81 000000A2 57                              	PUSH	EDI
    82 000000A3 56                              	PUSH	ESI
    83 000000A4 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    84 000000A7 53                              	PUSH	EBX
    85 000000A8 8B 7D 0C                        	MOV	EDI,DWORD [12+EBP]
    86 000000AB 8B 5D 10                        	MOV	EBX,DWORD [16+EBP]
    87 000000AE 8B 56 0C                        	MOV	EDX,DWORD [12+ESI]
    88 000000B1 42                              	INC	EDX
    89 000000B2 8B 47 18                        	MOV	EAX,DWORD [24+EDI]
    90 000000B5 39 D3                           	CMP	EBX,EDX
    91 000000B7 7E 02                           	JLE	L22
    92 000000B9 89 D3                           	MOV	EBX,EDX
    93 000000BB                                 L22:
    94 000000BB 83 FB FF                        	CMP	EBX,-1
    95 000000BE 7D 03                           	JGE	L23
    96 000000C0 83 CB FF                        	OR	EBX,-1
    97 000000C3                                 L23:
    98 000000C3 89 5F 18                        	MOV	DWORD [24+EDI],EBX
    99 000000C6 39 D8                           	CMP	EAX,EBX
   100 000000C8 7E 62                           	JLE	L24
   101 000000CA 85 DB                           	TEST	EBX,EBX
   102 000000CC 78 3B                           	JS	L25
   103 000000CE 89 C1                           	MOV	ECX,EAX
   104 000000D0                                 L30:
   105 000000D0 8B 44 8E 0C                     	MOV	EAX,DWORD [12+ESI+ECX*4]
   106 000000D4 89 44 8E 10                     	MOV	DWORD [16+ESI+ECX*4],EAX
   107 000000D8 89 48 18                        	MOV	DWORD [24+EAX],ECX
   108 000000DB 49                              	DEC	ECX
   109 000000DC 39 D9                           	CMP	ECX,EBX
   110 000000DE 7F F0                           	JG	L30
   111 000000E0                                 L56:
   112 000000E0 89 7C 9E 10                     	MOV	DWORD [16+ESI+EBX*4],EDI
   113 000000E4                                 L46:
   114 000000E4 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   115 000000E7 89 C8                           	MOV	EAX,ECX
   116 000000E9 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   117 000000EC 50                              	PUSH	EAX
   118 000000ED 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   119 000000F0 89 D0                           	MOV	EAX,EDX
   120 000000F2 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   121 000000F5 50                              	PUSH	EAX
   122 000000F6 51                              	PUSH	ECX
   123 000000F7 52                              	PUSH	EDX
   124 000000F8 56                              	PUSH	ESI
   125 000000F9 E8 000000BF                     	CALL	_sheet_refreshsub
   126 000000FE 83 C4 14                        	ADD	ESP,20
   127 00000101                                 L21:
   128 00000101 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   129 00000104 5B                              	POP	EBX
   130 00000105 5E                              	POP	ESI
   131 00000106 5F                              	POP	EDI
   132 00000107 5D                              	POP	EBP
   133 00000108 C3                              	RET
   134 00000109                                 L25:
   135 00000109 8B 56 0C                        	MOV	EDX,DWORD [12+ESI]
   136 0000010C 39 C2                           	CMP	EDX,EAX
   137 0000010E 7E 17                           	JLE	L32
   138 00000110 89 C1                           	MOV	ECX,EAX
   139 00000112 39 D0                           	CMP	EAX,EDX
   140 00000114 7D 11                           	JGE	L32
   141 00000116                                 L37:
   142 00000116 8B 44 8E 14                     	MOV	EAX,DWORD [20+ESI+ECX*4]
   143 0000011A 89 44 8E 10                     	MOV	DWORD [16+ESI+ECX*4],EAX
   144 0000011E 89 48 18                        	MOV	DWORD [24+EAX],ECX
   145 00000121 41                              	INC	ECX
   146 00000122 3B 4E 0C                        	CMP	ECX,DWORD [12+ESI]
   147 00000125 7C EF                           	JL	L37
   148 00000127                                 L32:
   149 00000127 FF 4E 0C                        	DEC	DWORD [12+ESI]
   150 0000012A EB B8                           	JMP	L46
   151 0000012C                                 L24:
   152 0000012C 39 D8                           	CMP	EAX,EBX
   153 0000012E 7D D1                           	JGE	L21
   154 00000130 85 C0                           	TEST	EAX,EAX
   155 00000132 78 18                           	JS	L40
   156 00000134 89 C1                           	MOV	ECX,EAX
   157 00000136 39 D8                           	CMP	EAX,EBX
   158 00000138 7D A6                           	JGE	L56
   159 0000013A                                 L45:
   160 0000013A 8B 44 8E 14                     	MOV	EAX,DWORD [20+ESI+ECX*4]
   161 0000013E 89 44 8E 10                     	MOV	DWORD [16+ESI+ECX*4],EAX
   162 00000142 89 48 18                        	MOV	DWORD [24+EAX],ECX
   163 00000145 41                              	INC	ECX
   164 00000146 39 D9                           	CMP	ECX,EBX
   165 00000148 7C F0                           	JL	L45
   166 0000014A EB 94                           	JMP	L56
   167 0000014C                                 L40:
   168 0000014C 8B 4E 0C                        	MOV	ECX,DWORD [12+ESI]
   169 0000014F 39 D9                           	CMP	ECX,EBX
   170 00000151 7C 13                           	JL	L58
   171 00000153                                 L51:
   172 00000153 8B 54 8E 10                     	MOV	EDX,DWORD [16+ESI+ECX*4]
   173 00000157 8D 41 01                        	LEA	EAX,DWORD [1+ECX]
   174 0000015A 89 54 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EDX
   175 0000015E 49                              	DEC	ECX
   176 0000015F 89 42 18                        	MOV	DWORD [24+EDX],EAX
   177 00000162 39 D9                           	CMP	ECX,EBX
   178 00000164 7D ED                           	JGE	L51
   179 00000166                                 L58:
   180 00000166 89 7C 9E 10                     	MOV	DWORD [16+ESI+EBX*4],EDI
   181 0000016A FF 46 0C                        	INC	DWORD [12+ESI]
   182 0000016D E9 FFFFFF72                     	JMP	L46
   183 00000172                                 	GLOBAL	_sheet_refresh
   184 00000172                                 _sheet_refresh:
   185 00000172 55                              	PUSH	EBP
   186 00000173 89 E5                           	MOV	EBP,ESP
   187 00000175 57                              	PUSH	EDI
   188 00000176 56                              	PUSH	ESI
   189 00000177 53                              	PUSH	EBX
   190 00000178 57                              	PUSH	EDI
   191 00000179 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   192 0000017C 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   193 0000017F 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   194 00000182 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
   195 00000185 8B 75 14                        	MOV	ESI,DWORD [20+EBP]
   196 00000188 8B 5D 18                        	MOV	EBX,DWORD [24+EBP]
   197 0000018B 8B 45 1C                        	MOV	EAX,DWORD [28+EBP]
   198 0000018E 83 7A 18 00                     	CMP	DWORD [24+EDX],0
   199 00000192 78 23                           	JS	L59
   200 00000194 8B 4A 10                        	MOV	ECX,DWORD [16+EDX]
   201 00000197 8B 52 0C                        	MOV	EDX,DWORD [12+EDX]
   202 0000019A 8D 04 08                        	LEA	EAX,DWORD [EAX+ECX*1]
   203 0000019D 01 F1                           	ADD	ECX,ESI
   204 0000019F 89 45 18                        	MOV	DWORD [24+EBP],EAX
   205 000001A2 89 4D 10                        	MOV	DWORD [16+EBP],ECX
   206 000001A5 8D 04 13                        	LEA	EAX,DWORD [EBX+EDX*1]
   207 000001A8 01 FA                           	ADD	EDX,EDI
   208 000001AA 89 45 14                        	MOV	DWORD [20+EBP],EAX
   209 000001AD 89 55 0C                        	MOV	DWORD [12+EBP],EDX
   210 000001B0 5E                              	POP	ESI
   211 000001B1 5B                              	POP	EBX
   212 000001B2 5E                              	POP	ESI
   213 000001B3 5F                              	POP	EDI
   214 000001B4 5D                              	POP	EBP
   215 000001B5 EB 06                           	JMP	_sheet_refreshsub
   216 000001B7                                 L59:
   217 000001B7 5B                              	POP	EBX
   218 000001B8 5B                              	POP	EBX
   219 000001B9 5E                              	POP	ESI
   220 000001BA 5F                              	POP	EDI
   221 000001BB 5D                              	POP	EBP
   222 000001BC C3                              	RET
   223 000001BD                                 	GLOBAL	_sheet_refreshsub
   224 000001BD                                 _sheet_refreshsub:
   225 000001BD 55                              	PUSH	EBP
   226 000001BE 89 E5                           	MOV	EBP,ESP
   227 000001C0 57                              	PUSH	EDI
   228 000001C1 56                              	PUSH	ESI
   229 000001C2 53                              	PUSH	EBX
   230 000001C3 83 EC 28                        	SUB	ESP,40
   231 000001C6 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   232 000001C9 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   233 000001CD 8B 00                           	MOV	EAX,DWORD [EAX]
   234 000001CF 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   235 000001D2 0F 88 00000128                  	JS	L92
   236 000001D8                                 L62:
   237 000001D8 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   238 000001DC 0F 88 00000112                  	JS	L93
   239 000001E2                                 L63:
   240 000001E2 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   241 000001E5 8B 42 04                        	MOV	EAX,DWORD [4+EDX]
   242 000001E8 39 45 14                        	CMP	DWORD [20+EBP],EAX
   243 000001EB 7E 03                           	JLE	L64
   244 000001ED 89 45 14                        	MOV	DWORD [20+EBP],EAX
   245 000001F0                                 L64:
   246 000001F0 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   247 000001F3 8B 46 08                        	MOV	EAX,DWORD [8+ESI]
   248 000001F6 39 45 14                        	CMP	DWORD [20+EBP],EAX
   249 000001F9 7E 03                           	JLE	L65
   250 000001FB 89 45 18                        	MOV	DWORD [24+EBP],EAX
   251 000001FE                                 L65:
   252 000001FE 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   253 00000201 31 FF                           	XOR	EDI,EDI
   254 00000203 C7 45 F0 00000000               	MOV	DWORD [-16+EBP],0
   255 0000020A 3B 78 0C                        	CMP	EDI,DWORD [12+EAX]
   256 0000020D 0F 8F 000000C6                  	JG	L87
   257 00000213                                 L85:
   258 00000213 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   259 00000216 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   260 00000219 8B 5D 10                        	MOV	EBX,DWORD [16+EBP]
   261 0000021C 8B 4C 96 10                     	MOV	ECX,DWORD [16+ESI+EDX*4]
   262 00000220 8B 75 14                        	MOV	ESI,DWORD [20+EBP]
   263 00000223 8B 39                           	MOV	EDI,DWORD [ECX]
   264 00000225 8B 51 10                        	MOV	EDX,DWORD [16+ECX]
   265 00000228 89 7D E0                        	MOV	DWORD [-32+EBP],EDI
   266 0000022B 8B 41 0C                        	MOV	EAX,DWORD [12+ECX]
   267 0000022E 8B 7D 18                        	MOV	EDI,DWORD [24+EBP]
   268 00000231 29 D3                           	SUB	EBX,EDX
   269 00000233 29 D7                           	SUB	EDI,EDX
   270 00000235 29 C6                           	SUB	ESI,EAX
   271 00000237 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   272 0000023A 89 75 CC                        	MOV	DWORD [-52+EBP],ESI
   273 0000023D 29 C2                           	SUB	EDX,EAX
   274 0000023F 89 7D D4                        	MOV	DWORD [-44+EBP],EDI
   275 00000242 89 55 E4                        	MOV	DWORD [-28+EBP],EDX
   276 00000245 0F 88 0000009D                  	JS	L94
   277 0000024B                                 L70:
   278 0000024B 85 DB                           	TEST	EBX,EBX
   279 0000024D 0F 88 0000008E                  	JS	L95
   280 00000253                                 L71:
   281 00000253 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   282 00000256 39 45 CC                        	CMP	DWORD [-52+EBP],EAX
   283 00000259 7E 03                           	JLE	L72
   284 0000025B 89 45 CC                        	MOV	DWORD [-52+EBP],EAX
   285 0000025E                                 L72:
   286 0000025E 8B 41 08                        	MOV	EAX,DWORD [8+ECX]
   287 00000261 39 45 D4                        	CMP	DWORD [-44+EBP],EAX
   288 00000264 7E 03                           	JLE	L73
   289 00000266 89 45 D4                        	MOV	DWORD [-44+EBP],EAX
   290 00000269                                 L73:
   291 00000269 3B 5D D4                        	CMP	EBX,DWORD [-44+EBP]
   292 0000026C 7D 59                           	JGE	L89
   293 0000026E                                 L84:
   294 0000026E 8B 71 10                        	MOV	ESI,DWORD [16+ECX]
   295 00000271 8B 55 E4                        	MOV	EDX,DWORD [-28+EBP]
   296 00000274 01 DE                           	ADD	ESI,EBX
   297 00000276 3B 55 CC                        	CMP	EDX,DWORD [-52+EBP]
   298 00000279 89 75 E8                        	MOV	DWORD [-24+EBP],ESI
   299 0000027C 7D 43                           	JGE	L91
   300 0000027E                                 L83:
   301 0000027E 89 D8                           	MOV	EAX,EBX
   302 00000280 8B 79 0C                        	MOV	EDI,DWORD [12+ECX]
   303 00000283 0F AF 41 04                     	IMUL	EAX,DWORD [4+ECX]
   304 00000287 01 D7                           	ADD	EDI,EDX
   305 00000289 8B 75 E0                        	MOV	ESI,DWORD [-32+EBP]
   306 0000028C 01 D0                           	ADD	EAX,EDX
   307 0000028E 89 7D EC                        	MOV	DWORD [-20+EBP],EDI
   308 00000291 8A 04 30                        	MOV	AL,BYTE [EAX+ESI*1]
   309 00000294 88 45 DF                        	MOV	BYTE [-33+EBP],AL
   310 00000297 0F B6 C0                        	MOVZX	EAX,AL
   311 0000029A 3B 41 14                        	CMP	EAX,DWORD [20+ECX]
   312 0000029D 74 1C                           	JE	L80
   313 0000029F 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   314 000002A2 8B 45 E8                        	MOV	EAX,DWORD [-24+EBP]
   315 000002A5 8B 75 D8                        	MOV	ESI,DWORD [-40+EBP]
   316 000002A8 0F AF 47 04                     	IMUL	EAX,DWORD [4+EDI]
   317 000002AC 03 45 EC                        	ADD	EAX,DWORD [-20+EBP]
   318 000002AF 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   319 000002B2 8A 45 DF                        	MOV	AL,BYTE [-33+EBP]
   320 000002B5 8B 7D D0                        	MOV	EDI,DWORD [-48+EBP]
   321 000002B8 88 04 37                        	MOV	BYTE [EDI+ESI*1],AL
   322 000002BB                                 L80:
   323 000002BB 42                              	INC	EDX
   324 000002BC 3B 55 CC                        	CMP	EDX,DWORD [-52+EBP]
   325 000002BF 7C BD                           	JL	L83
   326 000002C1                                 L91:
   327 000002C1 43                              	INC	EBX
   328 000002C2 3B 5D D4                        	CMP	EBX,DWORD [-44+EBP]
   329 000002C5 7C A7                           	JL	L84
   330 000002C7                                 L89:
   331 000002C7 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   332 000002CA FF 45 F0                        	INC	DWORD [-16+EBP]
   333 000002CD 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   334 000002D0 3B 42 0C                        	CMP	EAX,DWORD [12+EDX]
   335 000002D3 0F 8E FFFFFF3A                  	JLE	L85
   336 000002D9                                 L87:
   337 000002D9 83 C4 28                        	ADD	ESP,40
   338 000002DC 5B                              	POP	EBX
   339 000002DD 5E                              	POP	ESI
   340 000002DE 5F                              	POP	EDI
   341 000002DF 5D                              	POP	EBP
   342 000002E0 C3                              	RET
   343 000002E1                                 L95:
   344 000002E1 31 DB                           	XOR	EBX,EBX
   345 000002E3 E9 FFFFFF6B                     	JMP	L71
   346 000002E8                                 L94:
   347 000002E8 C7 45 E4 00000000               	MOV	DWORD [-28+EBP],0
   348 000002EF E9 FFFFFF57                     	JMP	L70
   349 000002F4                                 L93:
   350 000002F4 C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   351 000002FB E9 FFFFFEE2                     	JMP	L63
   352 00000300                                 L92:
   353 00000300 C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   354 00000307 E9 FFFFFECC                     	JMP	L62
   355 0000030C                                 	GLOBAL	_sheet_slide
   356 0000030C                                 _sheet_slide:
   357 0000030C 55                              	PUSH	EBP
   358 0000030D 89 E5                           	MOV	EBP,ESP
   359 0000030F 57                              	PUSH	EDI
   360 00000310 56                              	PUSH	ESI
   361 00000311 53                              	PUSH	EBX
   362 00000312 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
   363 00000315 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   364 00000318 8B 75 14                        	MOV	ESI,DWORD [20+EBP]
   365 0000031B 8B 4B 0C                        	MOV	ECX,DWORD [12+EBX]
   366 0000031E 8B 53 10                        	MOV	EDX,DWORD [16+EBX]
   367 00000321 89 7B 0C                        	MOV	DWORD [12+EBX],EDI
   368 00000324 89 73 10                        	MOV	DWORD [16+EBX],ESI
   369 00000327 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   370 0000032B 78 2F                           	JS	L96
   371 0000032D 89 D0                           	MOV	EAX,EDX
   372 0000032F 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   373 00000332 50                              	PUSH	EAX
   374 00000333 89 C8                           	MOV	EAX,ECX
   375 00000335 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   376 00000338 50                              	PUSH	EAX
   377 00000339 52                              	PUSH	EDX
   378 0000033A 51                              	PUSH	ECX
   379 0000033B FF 75 08                        	PUSH	DWORD [8+EBP]
   380 0000033E E8 FFFFFE7A                     	CALL	_sheet_refreshsub
   381 00000343 89 F0                           	MOV	EAX,ESI
   382 00000345 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   383 00000348 50                              	PUSH	EAX
   384 00000349 89 F8                           	MOV	EAX,EDI
   385 0000034B 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   386 0000034E 50                              	PUSH	EAX
   387 0000034F 56                              	PUSH	ESI
   388 00000350 57                              	PUSH	EDI
   389 00000351 FF 75 08                        	PUSH	DWORD [8+EBP]
   390 00000354 E8 FFFFFE64                     	CALL	_sheet_refreshsub
   391 00000359 83 C4 28                        	ADD	ESP,40
   392 0000035C                                 L96:
   393 0000035C 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   394 0000035F 5B                              	POP	EBX
   395 00000360 5E                              	POP	ESI
   396 00000361 5F                              	POP	EDI
   397 00000362 5D                              	POP	EBP
   398 00000363 C3                              	RET
   399 00000364                                 	GLOBAL	_sheet_free
   400 00000364                                 _sheet_free:
   401 00000364 55                              	PUSH	EBP
   402 00000365 89 E5                           	MOV	EBP,ESP
   403 00000367 53                              	PUSH	EBX
   404 00000368 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   405 0000036B 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   406 0000036F 7E 0E                           	JLE	L99
   407 00000371 6A FF                           	PUSH	-1
   408 00000373 53                              	PUSH	EBX
   409 00000374 FF 75 08                        	PUSH	DWORD [8+EBP]
   410 00000377 E8 FFFFFD23                     	CALL	_sheet_updown
   411 0000037C 83 C4 0C                        	ADD	ESP,12
   412 0000037F                                 L99:
   413 0000037F C7 43 1C 00000000               	MOV	DWORD [28+EBX],0
   414 00000386 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   415 00000389 C9                              	LEAVE
   416 0000038A C3                              	RET
