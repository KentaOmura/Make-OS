     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_memman_alloc_4k
     7 00000000                                 	EXTERN	_memman_free_4k
     8 00000000                                 [FILE "sheet.c"]
     9                                          [SECTION .text]
    10 00000000                                 	GLOBAL	_shtctl_init
    11 00000000                                 _shtctl_init:
    12 00000000 55                              	PUSH	EBP
    13 00000001 89 E5                           	MOV	EBP,ESP
    14 00000003 57                              	PUSH	EDI
    15 00000004 56                              	PUSH	ESI
    16 00000005 53                              	PUSH	EBX
    17 00000006 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    18 00000009 68 00002814                     	PUSH	10260
    19 0000000E 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
    20 00000011 56                              	PUSH	ESI
    21 00000012 E8 [00000000]                   	CALL	_memman_alloc_4k
    22 00000017 89 C3                           	MOV	EBX,EAX
    23 00000019 58                              	POP	EAX
    24 0000001A 5A                              	POP	EDX
    25 0000001B 31 C0                           	XOR	EAX,EAX
    26 0000001D 85 DB                           	TEST	EBX,EBX
    27 0000001F 74 4C                           	JE	L1
    28 00000021 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    29 00000024 0F AF C7                        	IMUL	EAX,EDI
    30 00000027 50                              	PUSH	EAX
    31 00000028 56                              	PUSH	ESI
    32 00000029 E8 [00000000]                   	CALL	_memman_alloc_4k
    33 0000002E 85 C0                           	TEST	EAX,EAX
    34 00000030 89 43 04                        	MOV	DWORD [4+EBX],EAX
    35 00000033 5A                              	POP	EDX
    36 00000034 59                              	POP	ECX
    37 00000035 74 3E                           	JE	L12
    38 00000037 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    39 0000003A 89 7B 08                        	MOV	DWORD [8+EBX],EDI
    40 0000003D 89 03                           	MOV	DWORD [EBX],EAX
    41 0000003F 8D 93 000023DC                  	LEA	EDX,DWORD [9180+EBX]
    42 00000045 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    43 00000048 89 43 0C                        	MOV	DWORD [12+EBX],EAX
    44 0000004B 89 D8                           	MOV	EAX,EBX
    45 0000004D C7 43 10 FFFFFFFF               	MOV	DWORD [16+EBX],-1
    46 00000054                                 L8:
    47 00000054 C7 80 00000430 00000000         	MOV	DWORD [1072+EAX],0
    48 0000005E 89 98 00000434                  	MOV	DWORD [1076+EAX],EBX
    49 00000064 83 C0 24                        	ADD	EAX,36
    50 00000067 39 D0                           	CMP	EAX,EDX
    51 00000069 7E E9                           	JLE	L8
    52 0000006B                                 L11:
    53 0000006B 89 D8                           	MOV	EAX,EBX
    54 0000006D                                 L1:
    55 0000006D 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
    56 00000070 5B                              	POP	EBX
    57 00000071 5E                              	POP	ESI
    58 00000072 5F                              	POP	EDI
    59 00000073 5D                              	POP	EBP
    60 00000074 C3                              	RET
    61 00000075                                 L12:
    62 00000075 68 00002814                     	PUSH	10260
    63 0000007A 53                              	PUSH	EBX
    64 0000007B 56                              	PUSH	ESI
    65 0000007C E8 [00000000]                   	CALL	_memman_free_4k
    66 00000081 EB E8                           	JMP	L11
    67 00000083                                 	GLOBAL	_sheet_alloc
    68 00000083                                 _sheet_alloc:
    69 00000083 55                              	PUSH	EBP
    70 00000084 31 D2                           	XOR	EDX,EDX
    71 00000086 89 E5                           	MOV	EBP,ESP
    72 00000088 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    73 0000008B 05 00000414                     	ADD	EAX,1044
    74 00000090                                 L19:
    75 00000090 83 78 1C 00                     	CMP	DWORD [28+EAX],0
    76 00000094 74 10                           	JE	L22
    77 00000096 42                              	INC	EDX
    78 00000097 83 C0 24                        	ADD	EAX,36
    79 0000009A 81 FA 000000FF                  	CMP	EDX,255
    80 000000A0 7E EE                           	JLE	L19
    81 000000A2 31 C0                           	XOR	EAX,EAX
    82 000000A4                                 L13:
    83 000000A4 5D                              	POP	EBP
    84 000000A5 C3                              	RET
    85 000000A6                                 L22:
    86 000000A6 C7 40 1C 00000001               	MOV	DWORD [28+EAX],1
    87 000000AD C7 40 18 FFFFFFFF               	MOV	DWORD [24+EAX],-1
    88 000000B4 EB EE                           	JMP	L13
    89 000000B6                                 	GLOBAL	_sheet_setbuf
    90 000000B6                                 _sheet_setbuf:
    91 000000B6 55                              	PUSH	EBP
    92 000000B7 89 E5                           	MOV	EBP,ESP
    93 000000B9 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    94 000000BC 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    95 000000BF 89 02                           	MOV	DWORD [EDX],EAX
    96 000000C1 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
    97 000000C4 89 42 04                        	MOV	DWORD [4+EDX],EAX
    98 000000C7 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    99 000000CA 89 42 08                        	MOV	DWORD [8+EDX],EAX
   100 000000CD 8B 45 18                        	MOV	EAX,DWORD [24+EBP]
   101 000000D0 89 42 14                        	MOV	DWORD [20+EDX],EAX
   102 000000D3 5D                              	POP	EBP
   103 000000D4 C3                              	RET
   104 000000D5                                 	GLOBAL	_sheet_updown
   105 000000D5                                 _sheet_updown:
   106 000000D5 55                              	PUSH	EBP
   107 000000D6 89 E5                           	MOV	EBP,ESP
   108 000000D8 57                              	PUSH	EDI
   109 000000D9 56                              	PUSH	ESI
   110 000000DA 53                              	PUSH	EBX
   111 000000DB 51                              	PUSH	ECX
   112 000000DC 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   113 000000DF 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
   114 000000E2 8B 77 20                        	MOV	ESI,DWORD [32+EDI]
   115 000000E5 8B 47 18                        	MOV	EAX,DWORD [24+EDI]
   116 000000E8 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   117 000000EB 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   118 000000EE 40                              	INC	EAX
   119 000000EF 39 C3                           	CMP	EBX,EAX
   120 000000F1 7E 02                           	JLE	L25
   121 000000F3 89 C3                           	MOV	EBX,EAX
   122 000000F5                                 L25:
   123 000000F5 83 FB FF                        	CMP	EBX,-1
   124 000000F8 7D 03                           	JGE	L26
   125 000000FA 83 CB FF                        	OR	EBX,-1
   126 000000FD                                 L26:
   127 000000FD 89 5F 18                        	MOV	DWORD [24+EDI],EBX
   128 00000100 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   129 00000103 0F 8E 000000A8                  	JLE	L27
   130 00000109 85 DB                           	TEST	EBX,EBX
   131 0000010B 78 5C                           	JS	L28
   132 0000010D 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   133 00000110                                 L33:
   134 00000110 8B 44 8E 10                     	MOV	EAX,DWORD [16+ESI+ECX*4]
   135 00000114 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   136 00000118 89 48 18                        	MOV	DWORD [24+EAX],ECX
   137 0000011B 49                              	DEC	ECX
   138 0000011C 39 D9                           	CMP	ECX,EBX
   139 0000011E 7F F0                           	JG	L33
   140 00000120 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   141 00000124 43                              	INC	EBX
   142 00000125 53                              	PUSH	EBX
   143 00000126 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   144 00000129 89 C8                           	MOV	EAX,ECX
   145 0000012B 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   146 0000012E 50                              	PUSH	EAX
   147 0000012F 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   148 00000132 89 D0                           	MOV	EAX,EDX
   149 00000134 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   150 00000137 50                              	PUSH	EAX
   151 00000138 51                              	PUSH	ECX
   152 00000139 52                              	PUSH	EDX
   153 0000013A 56                              	PUSH	ESI
   154 0000013B E8 00000115                     	CALL	_sheet_refreshmap
   155 00000140 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   156 00000143                                 L63:
   157 00000143 53                              	PUSH	EBX
   158 00000144                                 L62:
   159 00000144 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   160 00000147 89 C8                           	MOV	EAX,ECX
   161 00000149 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   162 0000014C 50                              	PUSH	EAX
   163 0000014D 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   164 00000150 89 D0                           	MOV	EAX,EDX
   165 00000152 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   166 00000155 50                              	PUSH	EAX
   167 00000156 51                              	PUSH	ECX
   168 00000157 52                              	PUSH	EDX
   169 00000158 56                              	PUSH	ESI
   170 00000159 E8 00000254                     	CALL	_sheet_refreshsub
   171 0000015E 83 C4 34                        	ADD	ESP,52
   172 00000161                                 L24:
   173 00000161 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   174 00000164 5B                              	POP	EBX
   175 00000165 5E                              	POP	ESI
   176 00000166 5F                              	POP	EDI
   177 00000167 5D                              	POP	EBP
   178 00000168 C3                              	RET
   179 00000169                                 L28:
   180 00000169 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   181 0000016C 3B 45 F0                        	CMP	EAX,DWORD [-16+EBP]
   182 0000016F 7E 18                           	JLE	L35
   183 00000171 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   184 00000174 39 C1                           	CMP	ECX,EAX
   185 00000176 7D 11                           	JGE	L35
   186 00000178                                 L40:
   187 00000178 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   188 0000017C 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   189 00000180 89 48 18                        	MOV	DWORD [24+EAX],ECX
   190 00000183 41                              	INC	ECX
   191 00000184 3B 4E 10                        	CMP	ECX,DWORD [16+ESI]
   192 00000187 7C EF                           	JL	L40
   193 00000189                                 L35:
   194 00000189 FF 4E 10                        	DEC	DWORD [16+ESI]
   195 0000018C 6A 00                           	PUSH	0
   196 0000018E 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   197 00000191 89 C8                           	MOV	EAX,ECX
   198 00000193 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   199 00000196 50                              	PUSH	EAX
   200 00000197 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   201 0000019A 89 D0                           	MOV	EAX,EDX
   202 0000019C 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   203 0000019F 50                              	PUSH	EAX
   204 000001A0 51                              	PUSH	ECX
   205 000001A1 52                              	PUSH	EDX
   206 000001A2 56                              	PUSH	ESI
   207 000001A3 E8 000000AD                     	CALL	_sheet_refreshmap
   208 000001A8 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   209 000001AB 48                              	DEC	EAX
   210 000001AC 50                              	PUSH	EAX
   211 000001AD 6A 00                           	PUSH	0
   212 000001AF EB 93                           	JMP	L62
   213 000001B1                                 L27:
   214 000001B1 39 5D F0                        	CMP	DWORD [-16+EBP],EBX
   215 000001B4 7D AB                           	JGE	L24
   216 000001B6 83 7D F0 00                     	CMP	DWORD [-16+EBP],0
   217 000001BA 78 3C                           	JS	L43
   218 000001BC 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   219 000001BF 39 D9                           	CMP	ECX,EBX
   220 000001C1 7D 10                           	JGE	L59
   221 000001C3                                 L48:
   222 000001C3 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   223 000001C7 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   224 000001CB 89 48 18                        	MOV	DWORD [24+EAX],ECX
   225 000001CE 41                              	INC	ECX
   226 000001CF 39 D9                           	CMP	ECX,EBX
   227 000001D1 7C F0                           	JL	L48
   228 000001D3                                 L59:
   229 000001D3 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   230 000001D7                                 L49:
   231 000001D7 53                              	PUSH	EBX
   232 000001D8 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   233 000001DB 89 C8                           	MOV	EAX,ECX
   234 000001DD 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   235 000001E0 50                              	PUSH	EAX
   236 000001E1 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   237 000001E4 89 D0                           	MOV	EAX,EDX
   238 000001E6 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   239 000001E9 50                              	PUSH	EAX
   240 000001EA 51                              	PUSH	ECX
   241 000001EB 52                              	PUSH	EDX
   242 000001EC 56                              	PUSH	ESI
   243 000001ED E8 00000063                     	CALL	_sheet_refreshmap
   244 000001F2 53                              	PUSH	EBX
   245 000001F3 E9 FFFFFF4B                     	JMP	L63
   246 000001F8                                 L43:
   247 000001F8 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   248 000001FB 39 D9                           	CMP	ECX,EBX
   249 000001FD 7C 13                           	JL	L61
   250 000001FF                                 L54:
   251 000001FF 8B 54 8E 14                     	MOV	EDX,DWORD [20+ESI+ECX*4]
   252 00000203 8D 41 01                        	LEA	EAX,DWORD [1+ECX]
   253 00000206 89 54 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EDX
   254 0000020A 49                              	DEC	ECX
   255 0000020B 89 42 18                        	MOV	DWORD [24+EDX],EAX
   256 0000020E 39 D9                           	CMP	ECX,EBX
   257 00000210 7D ED                           	JGE	L54
   258 00000212                                 L61:
   259 00000212 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   260 00000216 FF 46 10                        	INC	DWORD [16+ESI]
   261 00000219 EB BC                           	JMP	L49
   262 0000021B                                 	GLOBAL	_sheet_refresh
   263 0000021B                                 _sheet_refresh:
   264 0000021B 55                              	PUSH	EBP
   265 0000021C 89 E5                           	MOV	EBP,ESP
   266 0000021E 53                              	PUSH	EBX
   267 0000021F 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   268 00000222 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   269 00000225 85 C0                           	TEST	EAX,EAX
   270 00000227 78 27                           	JS	L64
   271 00000229 50                              	PUSH	EAX
   272 0000022A 50                              	PUSH	EAX
   273 0000022B 8B 4B 10                        	MOV	ECX,DWORD [16+EBX]
   274 0000022E 89 C8                           	MOV	EAX,ECX
   275 00000230 03 4D 10                        	ADD	ECX,DWORD [16+EBP]
   276 00000233 03 45 18                        	ADD	EAX,DWORD [24+EBP]
   277 00000236 50                              	PUSH	EAX
   278 00000237 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   279 0000023A 89 D0                           	MOV	EAX,EDX
   280 0000023C 03 55 0C                        	ADD	EDX,DWORD [12+EBP]
   281 0000023F 03 45 14                        	ADD	EAX,DWORD [20+EBP]
   282 00000242 50                              	PUSH	EAX
   283 00000243 51                              	PUSH	ECX
   284 00000244 52                              	PUSH	EDX
   285 00000245 FF 73 20                        	PUSH	DWORD [32+EBX]
   286 00000248 E8 00000165                     	CALL	_sheet_refreshsub
   287 0000024D 83 C4 1C                        	ADD	ESP,28
   288 00000250                                 L64:
   289 00000250 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   290 00000253 C9                              	LEAVE
   291 00000254 C3                              	RET
   292 00000255                                 	GLOBAL	_sheet_refreshmap
   293 00000255                                 _sheet_refreshmap:
   294 00000255 55                              	PUSH	EBP
   295 00000256 89 E5                           	MOV	EBP,ESP
   296 00000258 57                              	PUSH	EDI
   297 00000259 56                              	PUSH	ESI
   298 0000025A 53                              	PUSH	EBX
   299 0000025B 83 EC 28                        	SUB	ESP,40
   300 0000025E 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   301 00000261 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   302 00000265 8B 40 04                        	MOV	EAX,DWORD [4+EAX]
   303 00000268 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   304 0000026B 0F 88 00000135                  	JS	L97
   305 00000271                                 L67:
   306 00000271 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   307 00000275 0F 88 0000011F                  	JS	L98
   308 0000027B                                 L68:
   309 0000027B 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   310 0000027E 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   311 00000281 39 45 14                        	CMP	DWORD [20+EBP],EAX
   312 00000284 7E 03                           	JLE	L69
   313 00000286 89 45 14                        	MOV	DWORD [20+EBP],EAX
   314 00000289                                 L69:
   315 00000289 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   316 0000028C 8B 46 0C                        	MOV	EAX,DWORD [12+ESI]
   317 0000028F 39 45 18                        	CMP	DWORD [24+EBP],EAX
   318 00000292 7E 03                           	JLE	L70
   319 00000294 89 45 18                        	MOV	DWORD [24+EBP],EAX
   320 00000297                                 L70:
   321 00000297 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   322 0000029A 8B 7D 1C                        	MOV	EDI,DWORD [28+EBP]
   323 0000029D 89 7D F0                        	MOV	DWORD [-16+EBP],EDI
   324 000002A0 3B 78 10                        	CMP	EDI,DWORD [16+EAX]
   325 000002A3 0F 8F 000000D6                  	JG	L92
   326 000002A9                                 L90:
   327 000002A9 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   328 000002AC 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   329 000002AF 8B 5D 10                        	MOV	EBX,DWORD [16+EBP]
   330 000002B2 8B 4C 96 14                     	MOV	ECX,DWORD [20+ESI+EDX*4]
   331 000002B6 89 C8                           	MOV	EAX,ECX
   332 000002B8 29 F0                           	SUB	EAX,ESI
   333 000002BA 8B 39                           	MOV	EDI,DWORD [ECX]
   334 000002BC 2D 00000414                     	SUB	EAX,1044
   335 000002C1 8B 51 10                        	MOV	EDX,DWORD [16+ECX]
   336 000002C4 C1 F8 02                        	SAR	EAX,2
   337 000002C7 89 7D E0                        	MOV	DWORD [-32+EBP],EDI
   338 000002CA 69 C0 38E38E39                  	IMUL	EAX,EAX,954437177
   339 000002D0 8B 7D 18                        	MOV	EDI,DWORD [24+EBP]
   340 000002D3 29 D3                           	SUB	EBX,EDX
   341 000002D5 29 D7                           	SUB	EDI,EDX
   342 000002D7 88 45 DF                        	MOV	BYTE [-33+EBP],AL
   343 000002DA 8B 75 14                        	MOV	ESI,DWORD [20+EBP]
   344 000002DD 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   345 000002E0 8B 41 0C                        	MOV	EAX,DWORD [12+ECX]
   346 000002E3 89 7D D4                        	MOV	DWORD [-44+EBP],EDI
   347 000002E6 29 C6                           	SUB	ESI,EAX
   348 000002E8 29 C2                           	SUB	EDX,EAX
   349 000002EA 89 75 CC                        	MOV	DWORD [-52+EBP],ESI
   350 000002ED 89 55 E4                        	MOV	DWORD [-28+EBP],EDX
   351 000002F0 0F 88 00000098                  	JS	L99
   352 000002F6                                 L75:
   353 000002F6 85 DB                           	TEST	EBX,EBX
   354 000002F8 0F 88 00000089                  	JS	L100
   355 000002FE                                 L76:
   356 000002FE 8B 41 04                        	MOV	EAX,DWORD [4+ECX]
   357 00000301 39 45 CC                        	CMP	DWORD [-52+EBP],EAX
   358 00000304 7E 03                           	JLE	L77
   359 00000306 89 45 CC                        	MOV	DWORD [-52+EBP],EAX
   360 00000309                                 L77:
   361 00000309 8B 41 08                        	MOV	EAX,DWORD [8+ECX]
   362 0000030C 39 45 D4                        	CMP	DWORD [-44+EBP],EAX
   363 0000030F 7E 03                           	JLE	L78
   364 00000311 89 45 D4                        	MOV	DWORD [-44+EBP],EAX
   365 00000314                                 L78:
   366 00000314 3B 5D D4                        	CMP	EBX,DWORD [-44+EBP]
   367 00000317 7D 54                           	JGE	L94
   368 00000319                                 L89:
   369 00000319 8B 71 10                        	MOV	ESI,DWORD [16+ECX]
   370 0000031C 8B 55 E4                        	MOV	EDX,DWORD [-28+EBP]
   371 0000031F 01 DE                           	ADD	ESI,EBX
   372 00000321 3B 55 CC                        	CMP	EDX,DWORD [-52+EBP]
   373 00000324 89 75 E8                        	MOV	DWORD [-24+EBP],ESI
   374 00000327 7D 3E                           	JGE	L96
   375 00000329                                 L88:
   376 00000329 89 D8                           	MOV	EAX,EBX
   377 0000032B 8B 79 0C                        	MOV	EDI,DWORD [12+ECX]
   378 0000032E 0F AF 41 04                     	IMUL	EAX,DWORD [4+ECX]
   379 00000332 01 D7                           	ADD	EDI,EDX
   380 00000334 8B 75 E0                        	MOV	ESI,DWORD [-32+EBP]
   381 00000337 01 D0                           	ADD	EAX,EDX
   382 00000339 89 7D EC                        	MOV	DWORD [-20+EBP],EDI
   383 0000033C 0F B6 34 30                     	MOVZX	ESI,BYTE [EAX+ESI*1]
   384 00000340 3B 71 14                        	CMP	ESI,DWORD [20+ECX]
   385 00000343 74 1C                           	JE	L85
   386 00000345 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   387 00000348 8B 45 E8                        	MOV	EAX,DWORD [-24+EBP]
   388 0000034B 8B 75 D8                        	MOV	ESI,DWORD [-40+EBP]
   389 0000034E 0F AF 47 08                     	IMUL	EAX,DWORD [8+EDI]
   390 00000352 03 45 EC                        	ADD	EAX,DWORD [-20+EBP]
   391 00000355 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   392 00000358 8A 45 DF                        	MOV	AL,BYTE [-33+EBP]
   393 0000035B 8B 7D D0                        	MOV	EDI,DWORD [-48+EBP]
   394 0000035E 88 04 37                        	MOV	BYTE [EDI+ESI*1],AL
   395 00000361                                 L85:
   396 00000361 42                              	INC	EDX
   397 00000362 3B 55 CC                        	CMP	EDX,DWORD [-52+EBP]
   398 00000365 7C C2                           	JL	L88
   399 00000367                                 L96:
   400 00000367 43                              	INC	EBX
   401 00000368 3B 5D D4                        	CMP	EBX,DWORD [-44+EBP]
   402 0000036B 7C AC                           	JL	L89
   403 0000036D                                 L94:
   404 0000036D 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   405 00000370 FF 45 F0                        	INC	DWORD [-16+EBP]
   406 00000373 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   407 00000376 3B 42 10                        	CMP	EAX,DWORD [16+EDX]
   408 00000379 0F 8E FFFFFF2A                  	JLE	L90
   409 0000037F                                 L92:
   410 0000037F 83 C4 28                        	ADD	ESP,40
   411 00000382 5B                              	POP	EBX
   412 00000383 5E                              	POP	ESI
   413 00000384 5F                              	POP	EDI
   414 00000385 5D                              	POP	EBP
   415 00000386 C3                              	RET
   416 00000387                                 L100:
   417 00000387 31 DB                           	XOR	EBX,EBX
   418 00000389 E9 FFFFFF70                     	JMP	L76
   419 0000038E                                 L99:
   420 0000038E C7 45 E4 00000000               	MOV	DWORD [-28+EBP],0
   421 00000395 E9 FFFFFF5C                     	JMP	L75
   422 0000039A                                 L98:
   423 0000039A C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   424 000003A1 E9 FFFFFED5                     	JMP	L68
   425 000003A6                                 L97:
   426 000003A6 C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   427 000003AD E9 FFFFFEBF                     	JMP	L67
   428 000003B2                                 	GLOBAL	_sheet_refreshsub
   429 000003B2                                 _sheet_refreshsub:
   430 000003B2 55                              	PUSH	EBP
   431 000003B3 89 E5                           	MOV	EBP,ESP
   432 000003B5 57                              	PUSH	EDI
   433 000003B6 56                              	PUSH	ESI
   434 000003B7 53                              	PUSH	EBX
   435 000003B8 83 EC 2C                        	SUB	ESP,44
   436 000003BB 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   437 000003BE 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   438 000003C1 83 7D 0C 00                     	CMP	DWORD [12+EBP],0
   439 000003C5 8B 00                           	MOV	EAX,DWORD [EAX]
   440 000003C7 8B 52 04                        	MOV	EDX,DWORD [4+EDX]
   441 000003CA 89 45 DC                        	MOV	DWORD [-36+EBP],EAX
   442 000003CD 89 55 D8                        	MOV	DWORD [-40+EBP],EDX
   443 000003D0 0F 88 00000133                  	JS	L132
   444 000003D6                                 L102:
   445 000003D6 83 7D 10 00                     	CMP	DWORD [16+EBP],0
   446 000003DA 0F 88 0000011D                  	JS	L133
   447 000003E0                                 L103:
   448 000003E0 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   449 000003E3 8B 46 08                        	MOV	EAX,DWORD [8+ESI]
   450 000003E6 39 45 14                        	CMP	DWORD [20+EBP],EAX
   451 000003E9 7E 03                           	JLE	L104
   452 000003EB 89 45 14                        	MOV	DWORD [20+EBP],EAX
   453 000003EE                                 L104:
   454 000003EE 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   455 000003F1 8B 47 0C                        	MOV	EAX,DWORD [12+EDI]
   456 000003F4 39 45 14                        	CMP	DWORD [20+EBP],EAX
   457 000003F7 7E 03                           	JLE	L105
   458 000003F9 89 45 18                        	MOV	DWORD [24+EBP],EAX
   459 000003FC                                 L105:
   460 000003FC 8B 45 1C                        	MOV	EAX,DWORD [28+EBP]
   461 000003FF 8B 55 20                        	MOV	EDX,DWORD [32+EBP]
   462 00000402 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   463 00000405 39 D0                           	CMP	EAX,EDX
   464 00000407 0F 8F 000000BC                  	JG	L127
   465 0000040D                                 L125:
   466 0000040D 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   467 00000410 8B 75 F0                        	MOV	ESI,DWORD [-16+EBP]
   468 00000413 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   469 00000416 8B 5C B7 14                     	MOV	EBX,DWORD [20+EDI+ESI*4]
   470 0000041A 8B 75 14                        	MOV	ESI,DWORD [20+EBP]
   471 0000041D 8B 03                           	MOV	EAX,DWORD [EBX]
   472 0000041F 8B 53 10                        	MOV	EDX,DWORD [16+EBX]
   473 00000422 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   474 00000425 29 D1                           	SUB	ECX,EDX
   475 00000427 89 D8                           	MOV	EAX,EBX
   476 00000429 29 F8                           	SUB	EAX,EDI
   477 0000042B 8B 7D 18                        	MOV	EDI,DWORD [24+EBP]
   478 0000042E 2D 00000414                     	SUB	EAX,1044
   479 00000433 29 D7                           	SUB	EDI,EDX
   480 00000435 C1 F8 02                        	SAR	EAX,2
   481 00000438 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   482 0000043B 69 C0 38E38E39                  	IMUL	EAX,EAX,954437177
   483 00000441 88 45 D7                        	MOV	BYTE [-41+EBP],AL
   484 00000444 89 7D C8                        	MOV	DWORD [-56+EBP],EDI
   485 00000447 8B 43 0C                        	MOV	EAX,DWORD [12+EBX]
   486 0000044A 29 C6                           	SUB	ESI,EAX
   487 0000044C 29 C2                           	SUB	EDX,EAX
   488 0000044E 89 75 E4                        	MOV	DWORD [-28+EBP],ESI
   489 00000451 89 55 E8                        	MOV	DWORD [-24+EBP],EDX
   490 00000454 0F 88 00000097                  	JS	L134
   491 0000045A                                 L110:
   492 0000045A 85 C9                           	TEST	ECX,ECX
   493 0000045C 0F 88 00000088                  	JS	L135
   494 00000462                                 L111:
   495 00000462 8B 43 04                        	MOV	EAX,DWORD [4+EBX]
   496 00000465 39 45 E4                        	CMP	DWORD [-28+EBP],EAX
   497 00000468 7E 03                           	JLE	L112
   498 0000046A 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   499 0000046D                                 L112:
   500 0000046D 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   501 00000470 39 45 C8                        	CMP	DWORD [-56+EBP],EAX
   502 00000473 7E 03                           	JLE	L113
   503 00000475 89 45 C8                        	MOV	DWORD [-56+EBP],EAX
   504 00000478                                 L113:
   505 00000478 89 CE                           	MOV	ESI,ECX
   506 0000047A 3B 4D C8                        	CMP	ECX,DWORD [-56+EBP]
   507 0000047D 7D 3B                           	JGE	L129
   508 0000047F                                 L124:
   509 0000047F 8B 7B 10                        	MOV	EDI,DWORD [16+EBX]
   510 00000482 8B 4D E8                        	MOV	ECX,DWORD [-24+EBP]
   511 00000485 01 F7                           	ADD	EDI,ESI
   512 00000487 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   513 0000048A 89 7D EC                        	MOV	DWORD [-20+EBP],EDI
   514 0000048D 7D 25                           	JGE	L131
   515 0000048F                                 L123:
   516 0000048F 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   517 00000492 8B 7D EC                        	MOV	EDI,DWORD [-20+EBP]
   518 00000495 8B 43 0C                        	MOV	EAX,DWORD [12+EBX]
   519 00000498 0F AF 7A 08                     	IMUL	EDI,DWORD [8+EDX]
   520 0000049C 01 C8                           	ADD	EAX,ECX
   521 0000049E 8A 55 D7                        	MOV	DL,BYTE [-41+EBP]
   522 000004A1 01 F8                           	ADD	EAX,EDI
   523 000004A3 8B 7D D8                        	MOV	EDI,DWORD [-40+EBP]
   524 000004A6 89 45 CC                        	MOV	DWORD [-52+EBP],EAX
   525 000004A9 38 14 38                        	CMP	BYTE [EAX+EDI*1],DL
   526 000004AC 74 23                           	JE	L136
   527 000004AE                                 L120:
   528 000004AE 41                              	INC	ECX
   529 000004AF 3B 4D E4                        	CMP	ECX,DWORD [-28+EBP]
   530 000004B2 7C DB                           	JL	L123
   531 000004B4                                 L131:
   532 000004B4 46                              	INC	ESI
   533 000004B5 3B 75 C8                        	CMP	ESI,DWORD [-56+EBP]
   534 000004B8 7C C5                           	JL	L124
   535 000004BA                                 L129:
   536 000004BA 8B 75 20                        	MOV	ESI,DWORD [32+EBP]
   537 000004BD FF 45 F0                        	INC	DWORD [-16+EBP]
   538 000004C0 39 75 F0                        	CMP	DWORD [-16+EBP],ESI
   539 000004C3 0F 8E FFFFFF44                  	JLE	L125
   540 000004C9                                 L127:
   541 000004C9 83 C4 2C                        	ADD	ESP,44
   542 000004CC 5B                              	POP	EBX
   543 000004CD 5E                              	POP	ESI
   544 000004CE 5F                              	POP	EDI
   545 000004CF 5D                              	POP	EBP
   546 000004D0 C3                              	RET
   547 000004D1                                 L136:
   548 000004D1 89 F0                           	MOV	EAX,ESI
   549 000004D3 8B 55 E0                        	MOV	EDX,DWORD [-32+EBP]
   550 000004D6 0F AF 43 04                     	IMUL	EAX,DWORD [4+EBX]
   551 000004DA 01 C8                           	ADD	EAX,ECX
   552 000004DC 8B 7D DC                        	MOV	EDI,DWORD [-36+EBP]
   553 000004DF 8A 04 10                        	MOV	AL,BYTE [EAX+EDX*1]
   554 000004E2 8B 55 CC                        	MOV	EDX,DWORD [-52+EBP]
   555 000004E5 88 04 3A                        	MOV	BYTE [EDX+EDI*1],AL
   556 000004E8 EB C4                           	JMP	L120
   557 000004EA                                 L135:
   558 000004EA 31 C9                           	XOR	ECX,ECX
   559 000004EC E9 FFFFFF71                     	JMP	L111
   560 000004F1                                 L134:
   561 000004F1 C7 45 E8 00000000               	MOV	DWORD [-24+EBP],0
   562 000004F8 E9 FFFFFF5D                     	JMP	L110
   563 000004FD                                 L133:
   564 000004FD C7 45 10 00000000               	MOV	DWORD [16+EBP],0
   565 00000504 E9 FFFFFED7                     	JMP	L103
   566 00000509                                 L132:
   567 00000509 C7 45 0C 00000000               	MOV	DWORD [12+EBP],0
   568 00000510 E9 FFFFFEC1                     	JMP	L102
   569 00000515                                 	GLOBAL	_sheet_slide
   570 00000515                                 _sheet_slide:
   571 00000515 55                              	PUSH	EBP
   572 00000516 89 E5                           	MOV	EBP,ESP
   573 00000518 57                              	PUSH	EDI
   574 00000519 56                              	PUSH	ESI
   575 0000051A 53                              	PUSH	EBX
   576 0000051B 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   577 0000051E 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   578 00000521 8B 7B 0C                        	MOV	EDI,DWORD [12+EBX]
   579 00000524 8B 73 10                        	MOV	ESI,DWORD [16+EBX]
   580 00000527 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   581 0000052A 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   582 0000052D 89 43 10                        	MOV	DWORD [16+EBX],EAX
   583 00000530 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   584 00000534 78 7C                           	JS	L137
   585 00000536 6A 00                           	PUSH	0
   586 00000538 89 F0                           	MOV	EAX,ESI
   587 0000053A 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   588 0000053D 50                              	PUSH	EAX
   589 0000053E 89 F8                           	MOV	EAX,EDI
   590 00000540 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   591 00000543 50                              	PUSH	EAX
   592 00000544 56                              	PUSH	ESI
   593 00000545 57                              	PUSH	EDI
   594 00000546 FF 73 20                        	PUSH	DWORD [32+EBX]
   595 00000549 E8 FFFFFD07                     	CALL	_sheet_refreshmap
   596 0000054E 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   597 00000551 FF 73 18                        	PUSH	DWORD [24+EBX]
   598 00000554 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   599 00000557 50                              	PUSH	EAX
   600 00000558 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   601 0000055B 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   602 0000055E 50                              	PUSH	EAX
   603 0000055F FF 75 10                        	PUSH	DWORD [16+EBP]
   604 00000562 FF 75 0C                        	PUSH	DWORD [12+EBP]
   605 00000565 FF 73 20                        	PUSH	DWORD [32+EBX]
   606 00000568 E8 FFFFFCE8                     	CALL	_sheet_refreshmap
   607 0000056D 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   608 00000570 83 C4 30                        	ADD	ESP,48
   609 00000573 48                              	DEC	EAX
   610 00000574 50                              	PUSH	EAX
   611 00000575 89 F0                           	MOV	EAX,ESI
   612 00000577 6A 00                           	PUSH	0
   613 00000579 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   614 0000057C 50                              	PUSH	EAX
   615 0000057D 89 F8                           	MOV	EAX,EDI
   616 0000057F 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   617 00000582 50                              	PUSH	EAX
   618 00000583 56                              	PUSH	ESI
   619 00000584 57                              	PUSH	EDI
   620 00000585 FF 73 20                        	PUSH	DWORD [32+EBX]
   621 00000588 E8 FFFFFE25                     	CALL	_sheet_refreshsub
   622 0000058D 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   623 00000590 FF 73 18                        	PUSH	DWORD [24+EBX]
   624 00000593 FF 73 18                        	PUSH	DWORD [24+EBX]
   625 00000596 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   626 00000599 50                              	PUSH	EAX
   627 0000059A 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   628 0000059D 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   629 000005A0 50                              	PUSH	EAX
   630 000005A1 FF 75 10                        	PUSH	DWORD [16+EBP]
   631 000005A4 FF 75 0C                        	PUSH	DWORD [12+EBP]
   632 000005A7 FF 73 20                        	PUSH	DWORD [32+EBX]
   633 000005AA E8 FFFFFE03                     	CALL	_sheet_refreshsub
   634 000005AF 83 C4 38                        	ADD	ESP,56
   635 000005B2                                 L137:
   636 000005B2 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   637 000005B5 5B                              	POP	EBX
   638 000005B6 5E                              	POP	ESI
   639 000005B7 5F                              	POP	EDI
   640 000005B8 5D                              	POP	EBP
   641 000005B9 C3                              	RET
   642 000005BA                                 	GLOBAL	_sheet_free
   643 000005BA                                 _sheet_free:
   644 000005BA 55                              	PUSH	EBP
   645 000005BB 89 E5                           	MOV	EBP,ESP
   646 000005BD 53                              	PUSH	EBX
   647 000005BE 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   648 000005C1 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   649 000005C5 7E 0A                           	JLE	L140
   650 000005C7 6A FF                           	PUSH	-1
   651 000005C9 53                              	PUSH	EBX
   652 000005CA E8 FFFFFB06                     	CALL	_sheet_updown
   653 000005CF 58                              	POP	EAX
   654 000005D0 5A                              	POP	EDX
   655 000005D1                                 L140:
   656 000005D1 C7 43 1C 00000000               	MOV	DWORD [28+EBX],0
   657 000005D8 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   658 000005DB C9                              	LEAVE
   659 000005DC C3                              	RET
